# 🍊Tamnara-BE

**타임라인 기반 뉴스 탐색 플랫폼, 탐나라**의 백엔드입니다.<br/>
사용자는 뉴스를 검색하거나 생성/업데이트할 수 있으며, 뉴스는 타임라인 형태로 요약되어 최신순으로 정렬됩니다.<br/>
이를 통해 사용자는 빠르게 최신 이슈의 흐름과 인과를 한눈에 파악할 수 있습니다.<br/>

<br/>

## 주요 기능
### 🤝 인증・인가
- **HttpOnly Secure 쿠키 기반 인증:** access token, refresh token을 쿠키에 저장하여 CSRF 및 XSS 방어
- **JWT 토큰 관리:** access token과 refresh token 발급 및 검증
- **Redis 연동:** refresh token과 로그인 세션 관리

### 👤 회원
- 카카오 OAuth 로그인/회원가입 (providerId, email, username 관리)
- 탈퇴(soft delete) 시 상태 전환 및 withdrawnAt 처리
- 탈퇴 회원 복구 시 withdrawnAt 초기화 및 상태 복구
- 회원 정보(닉네임) 수정

### 🗞️ 뉴스
- **뉴스 생성/업데이트:** 3개의 외부 뉴스 API를 병렬/직렬 혼합 방식으로 연동 후, 가장 신뢰도 높은 데이터를 기반으로 뉴스 카드 생성
- **핫이슈 자동 생성:** 매일 오전 9시에 스케줄러를 통해 주요 키워드 기반 핫이슈 뉴스 자동 생성 (최대 3건)
- **검색 기능:** 키워드 가중치 기반 뉴스 검색, 다중 태그 지원
- **북마크:** 뉴스 북마크 추가/삭제 및 북마크 리스트 조회
- **댓글:** 댓글 작성/삭제, 작성자 식별 및 soft delete 처리 대응

### 🔔 알림
- **이벤트 기반 알림 발행:** 뉴스 업데이트, 삭제, 북마크 이벤트 등 발생 시 관련 회원에게 알림 생성
- **알림 저장:** Redis에 저장하여 빠른 조회 및 실시간성 확보
- 종류:
   - 핫이슈 생성 시 전체 알림
   - 북마크한 뉴스 업데이트, 삭제 예고 및 삭제 완료 알림 
   - 투표 시작 및 투표 결과 공개 알림

### 🗳️ 투표
- **자동 공개 스케줄링:** 매주 월요일 오전 10시에 새로운 투표 자동 공개
- **투표 참여 제어:** 사용자당 주 1회 참여 제한 및 선택지 기록
- **투표 결과 집계:** 선택지별 투표 수 실시간 집계

<br/>

## 기술 스택
- Spring Boot 3.x
- Spring Security (JWT 기반 인증/인가)
- Redis (refresh token 및 알림 관리)
- MySQL (RDS)
- Scheduler (Spring Scheduling)

<br/>

## DB 설계
- users: OAuth 정보, 상태(State), 탈퇴일 관리
- news: 외부 API 참조 정보 포함
- comments: soft delete 대응, 작성자 null 처리
- bookmark: 회원-뉴스 다대다 매핑
- alarms: Redis 기반 저장 및 관리
- polls & votes: 투표 및 선택지, 사용자 참여 내역

<br/>

## 기타
- OAuth 인증 실패/만료 대응 로직 포함
- Soft delete 사용자 대응 및 복구 로직
- 회원, 뉴스, 댓글 관련 에러 케이스에 대한 공통 예외 처리
- 서비스 레이어 책임 분리 및 테스트 코드 작성
